<!DOCTYPE html>
<html>

  <head>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/sidebar.css"/>
  </head>

<body class="nopadding">
  <!-- Fixed navbar -->
  <div class="navbar navbar-static navbar-fixed-top buttons">
    <div class="container-fluid nopadding col-xs-12 col-sm-12 col-md-3">
      <div class="navbar-container">
        <a type="button" class="navbar-toggle toggle-left  nopadding" data-toggle="sidebar" data-target=".sidebar-left">
          <img src="images/logo.svg">
        </a>

        <a id="button-position" style="margin-left: 2em;">
          <img src="images/preloader.svg" class="spin">
        </a>
     </div>

<!--
        <button type="button" class="navbar-toggle toggle-right col-xs-3 nopadding" data-toggle="sidebar" data-target=".sidebar-right">
          <img src="images/filters.svg">
        </button>
-->
    </div>
  </div>
  
  <!-- Begin page content -->
  <div class="container-fluid">
    <div class="row">
      <!-- left -->
      <div class="col-xs-12 col-sm-12 col-md-3 sidebar sidebar-left sidebar-animate sidebar-md-show">
        <div style="width:80%; margin:0 auto; font-size: 0.8em"> 
          <strong>MOI HELSINKI</strong><br>
          is a location-based event calendar for Helsinki area.  In its current implementation, it aggregates and visualizes events retrieved from the Facebook API. The default listing interface displays the current location of the user as the starting point to locate events of possible interest. The website provides additional sorting and filtering opportunities to adjust the listing in ways that are meaningful to the user.
        </div>
        <!--
        <img src="images/about_box.svg" width="80%" style="margin-top:20%">
        -->
      </div>

      <!-- center -->
      <div class="main col-md-8 col-md-offset-4">

        <!-- Events -->
        <div id="events">
          {{#events}}
          <div class="event">
            <p class="event-details">
              {{#distance}}{{distance}} km | {{/distance}}{{venue_address}} | {{time}}
            </p>
            <h2 class="subheader">
              <a href="http://facebook.com/{{id}}" target="_blank">   
                {{name}}
              </a>
            </h2>
            <p class="event-venue-name">
              {{venue_name}}
            </p>
          </div>
          {{/events}}
        </div>

      </div>

      <!-- right 
      <div class="col-xs-12 col-sm-12 col-md-3 sidebar sidebar-right sidebar-animate sidebar-md-show">
        <div style="width:80%; margin:0 auto; font-size: 0.8em"> 

        </div>
      </div>
      -->

    </div>
  </div>
</body>

<!--         -->
<!-- SCRIPTS -->
<!--         -->

<script src="js/socket.io.js"></script>
<script src="js/jquery.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/sidebar.js"></script>
<script>
  var socket = io( "http://localhost:8080");
  var userPosition;
  
  window.onload = function() {
    var geoSuccess = function(position) {
      userPosition = {latitude: position.coords.latitude, longitude: position.coords.longitude};
      socket.emit('position', {latitude: userPosition.latitude, longitude: userPosition.longitude});
      document.getElementById('button-position').innerHTML = "<img src='images/location.svg'>";
    };
    navigator.geolocation.getCurrentPosition(geoSuccess);
  };

  $( "#button-position" ).click(function() {
    if(userPosition) socket.emit('sort-distance', userPosition);
  });

  socket.on('sort-distance', function(events){
    // Client side recieves pre-rendered sorted list of events from the server and embeds it into the page
    document.getElementById('events').innerHTML = events;
  });

</script>

</html>

<!-- location.svg  // GPS by Alfredo Hernandez from the Noun Project -->
<!-- preloader.svg // loading by Parma from the Noun Project -->